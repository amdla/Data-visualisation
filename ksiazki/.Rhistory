install.packages(c("tidyverse", "lubridate", "hexbin", "RColorBrewer", "janitor", "ggplot2"))
# Set common theme elements
theme_set(theme_minimal(base_size = 14) +
theme(
plot.title = element_text(size = 20, face = "bold", hjust = 0.5, margin = margin(b = 30)),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
panel.grid.major = element_line(color = "gray90", linetype = "dashed"),
panel.grid.minor = element_blank()
))
library(ggplot2)
library(tidyverse)
library(lubridate)
library(hexbin)
library(RColorBrewer)
library(janitor)
library(ggplot2)
# Load and clean data
df <- read_csv("books_cleaned.csv") %>%
drop_na() %>%
clean_names()
library(tidyverse)
library(lubridate)
library(hexbin)
library(RColorBrewer)
library(janitor)
# Load and clean data
df <- read_csv("books_cleaned.csv") %>%
drop_na() %>%
clean_names()
setwd("C:/Users/macie/PycharmProjects/Data-visualisation/ksiazki")
library(tidyverse)
library(lubridate)
library(hexbin)
library(RColorBrewer)
library(janitor)
# Load and clean data
df <- read_csv("books_cleaned.csv") %>%
drop_na() %>%
clean_names()
# Set common theme elements
theme_set(theme_minimal(base_size = 14) +
theme(
plot.title = element_text(size = 20, face = "bold", hjust = 0.5, margin = margin(b = 30)),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
panel.grid.major = element_line(color = "gray90", linetype = "dashed"),
panel.grid.minor = element_blank()
))
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
p1
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
print(p1)
View(p1)
View(p1)
setwd("C:/Users/macie/PycharmProjects/Data-visualisation/ksiazki")
library(tidyverse)
library(lubridate)
library(hexbin)
library(RColorBrewer)
library(janitor)
# Load and clean data
df <- read_csv("books_cleaned.csv") %>%
drop_na() %>%
clean_names()
# Set common theme elements
theme_set(theme_minimal(base_size = 14) +
theme(
plot.title = element_text(size = 20, face = "bold", hjust = 0.5, margin = margin(b = 30)),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
panel.grid.major = element_line(color = "gray90", linetype = "dashed"),
panel.grid.minor = element_blank()
))
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
print(p1)
ggsave("rating_plot.png", p1, width = 10, height = 6, dpi = 300)
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
windows()
p1
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
windows()
p1
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
windows()
p1
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
windows()
p1
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
windows()
p1
# 1. Rating Distribution Histogram
p1 <- ggplot(df, aes(average_rating)) +
geom_histogram(bins = 20, fill = "#1F77B4", color = "white") +
geom_text(stat = "bin", bins = 20, aes(label = after_stat(count)),
vjust = -0.5, size = 5, fontface = "bold") +
scale_x_continuous(limits = c(0, 5)) +
labs(x = "Average Rating", y = "Frequency",
title = "Distribution of Book Ratings with Counts") +
theme(plot.margin = margin(30, 20, 20, 20))
windows()
p1
